<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Fair Chair</title>
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/jquery.min.js"></script>
    <script>
      window.$ = window.jQuery = require('./js/jquery.min.js');
    </script>
    <script src="js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row row-full">
        <div class="col-sm-6">
          <div class="well">
            <div class="row">
              <div class="col-sm-8">
                <div class="big-time" id="time-timer">
                  0:00
                </div>
              </div>
              <div class="col-sm-4">
                <button class="btn btn-block btn-primary" id="time-toggle"><span class="fa fa-play"></span> <span class="fa fa-pause"></span></button>
                <button class="btn btn-block btn-danger" id="time-stop"><span class="fa fa-stop"></span></button>
              </div>
            </div>
            <div class="row padding-top">
              <div class="col-sm-8">
                <input class="form-control" id="time-input" type="text" placeholder="Enter time in minutes:seconds e.g. 10:00"/>
              </div>
              <div class="col-sm-4">
                <button class="btn btn-success" id="time-add"><span class="fa fa-plus"></span></button>
              </div>
            </div>
          </div>
          <div class="well">
            <textarea class="form-control" style="font-size: 4em; height:100%;" rows="4" placeholder="Committee Notes"></textarea>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="well">
            <ul class="nav nav-tabs" role="tablist">
              <li role="presentation" class="active"><a href="#primary" role="tab" data-toggle="tab">Primary</a></li>
              <li role="presentation"><a href="#secondary" role="tab" data-toggle="tab">Secondary</a></li>
              <li role="presentation"><a href="#caucas" role="tab" data-toggle="tab">Caucas</a></li>
            </ul>
            <div class="tab-content view-fixed" id="view-fixed">
              <div role="tabpanel" class="tab-pane active" id="primary">
                <table class="table">
                  <thead>
                    <tr>
                      <th>
                        #
                      </th>
                      <th>
                        Delegation
                      </th>
                      <th class="text-right">
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody id="table-primary">
                    <tr>
                      <td>
                        0
                      </td>
                      <td>
                        Add speakers to get started!
                      </td>
                      <td class="text-right">
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="row">
                  <div class="col-sm-8">
                    <input class="form-control" type="text" placeholder="Delegation Name" id="input-primary"/>
                  </div>
                  <div class="col-sm-4">
                    <button class="btn btn-success" id="add-primary"><span class="fa fa-plus"></span></button>
                    <button class="btn btn-danger" id="clear-primary">Clear List</button>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="secondary">
                <table class="table">
                  <thead>
                    <tr>
                      <th>
                        #
                      </th>
                      <th>
                        Delegation
                      </th>
                      <th class="text-right">
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody id="table-secondary">
                    <tr>
                      <td>
                        0
                      </td>
                      <td>
                        Add speakers to get started!
                      </td>
                      <td class="text-right">
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="row">
                  <div class="col-sm-8">
                    <input class="form-control" type="text" placeholder="Delegation Name" id="input-secondary"/>
                  </div>
                  <div class="col-sm-4">
                    <button class="btn btn-success" id="add-secondary"><span class="fa fa-plus"></span></button>
                    <button class="btn btn-danger" id="clear-secondary">Clear List</button>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="caucas">
                <table class="table">
                  <thead>
                    <tr>
                      <th>
                        #
                      </th>
                      <th>
                        Delegation
                      </th>
                      <th class="text-right">
                        Actions
                      </th>
                    </tr>
                  </thead>
                  <tbody id="table-caucas">
                    <tr>
                      <td>
                        0
                      </td>
                      <td>
                        Add speakers to get started!
                      </td>
                      <td class="text-right">
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="row">
                  <div class="col-sm-8">
                    <input class="form-control" type="text" placeholder="Delegation Name" id="input-caucas"/>
                  </div>
                  <div class="col-sm-4">
                    <button class="btn btn-success" id="add-caucas"><span class="fa fa-plus"></span></button>
                    <button class="btn btn-danger" id="clear-caucas">Clear List</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="well">
        <div class="row">
          <div class="col-sm-6">
            <h1>Fair Chair</h1>
            Developed by <a href="https://github.com/malsf21">Matthew Wang</a> for use at <a href="https://omun.ca">Ontario Model United Nations</a>
          </div>
          <div class="col-sm-6">
            <img class="img-responsive" src="img/omun.png" style="max-width:20%; margin-left:auto;"/>
          </div>
        </div>
        Running node <script>document.write(process.versions.node)</script>,
        Chrome <script>document.write(process.versions.chrome)</script>,
        and Electron <script>document.write(process.versions.electron)</script>.
      </div>
    </div>
    <script>
      timer = {
        "on": false,
        "seconds": 0
      }
      speakers = {
        "primary": [

        ],
        "secondary": [

        ],
        "caucas": [

        ]
      }
      function getTimer(timer){
        temp = timer["seconds"]%60
        if (temp < 10){
          temp = "0" + temp;
        }
        return Math.floor(timer["seconds"]/60) + ":" + temp;
      }
      function incrementTimer(timer){
        if (timer["seconds"] != 0){
          timer["seconds"] = timer["seconds"] - 1;
        }
      }
      function addSpeaker(speakers, list){
        speakers[list].push({"name": $("#input-" + list).val(), "style": "none"});
        renderSpeakers(speakers, list);
      }
      function strikeSpeaker(list, id){
        speakers[list][id]["style"] = "strike";
        renderSpeakers(speakers, list);
      }
      function removeSpeaker(list, id){
        speakers[list].splice(id,1);
        renderSpeakers(speakers, list);
      }
      function renderSpeakers(speakers,list){
        $("#table-" + list).html("");
        for(i = 0; i < speakers[list].length; i++){
          style = "";
          if (speakers[list][i]["style"] == "strike"){
            style = " style='text-decoration: line-through;'";
          }
          /*
          <tr>
            <td' + style + '>
              ' + (i + 1) + '
            </td>
            <td' + style + '>
              ' + speakers[list][i]["name"] + '
            </td>
            <td class="text-right">
              <button class="btn btn-success" onclick="strikeSpeaker(\''+ list +'\', '+ i +')"><span class="fa fa-check"></span></button>
              <button class="btn btn-danger" onclick="removeSpeaker(\''+ list +'\', '+ i +')"><span class="fa fa-remove"></span></button>
            </td>
          </tr>
          */
          $("#table-" + list).append('<tr><td' + style + '>' + (i + 1) + '</td><td' + style + '>' + speakers[list][i]["name"] + '</td><td class="text-right"><button class="btn btn-success" onclick="strikeSpeaker(\''+ list +'\', '+ i +')"><span class="fa fa-check"></span></button><button class="btn btn-danger" onclick="removeSpeaker(\''+ list +'\', '+ i +')"><span class="fa fa-remove"></span></button></td></tr>'
          );
        }
      }
      function updateScroll(){
      var element = document.getElementById("view-fixed");
        element.scrollTop = element.scrollHeight;
      }

      $("#time-toggle").click(function(){
        timer["on"] = !(timer["on"]);
      });
      $("#time-stop").click(function(){
        timer["seconds"] = 0;
        $("#time-timer").html(getTimer(timer));
      });
      $("#time-add").click(function(){
        temp = $("#time-input").val().split(":");
        timer["seconds"] = 60*temp[0]+Number(temp[1]);
        $("#time-timer").html(getTimer(timer));
        $("#time-input").val("");
      });
      $("#time-input").keyup(function(event){
        if(event.keyCode == 13){
          $("#time-add").click();
        }
      });
      $("#add-primary").click(function(){
        addSpeaker(speakers, "primary");
        $("#input-primary").val("");
        updateScroll();
      });
      $("#add-secondary").click(function(){
        addSpeaker(speakers, "secondary");
        $("#input-secondary").val("");
        updateScroll();
      });
      $("#add-caucas").click(function(){
        addSpeaker(speakers, "caucas");
        $("#input-caucas").val("");
        updateScroll();
      });
      $("#input-primary").keyup(function(event){
        if(event.keyCode == 13){
          $("#add-primary").click();
        }
      });
      $("#input-secondary").keyup(function(event){
        if(event.keyCode == 13){
          $("#add-secondary").click();
        }
      });
      $("#input-caucas").keyup(function(event){
        if(event.keyCode == 13){
          $("#add-caucas").click();
        }
      });
      /*
        <tr>
          <td>
            0
          </td>
          <td>
            Add speakers to get started!
          </td>
          <td class="text-right">
          </td>
        </tr>
      */
      $("#clear-primary").click(function(){
        $("#table-primary").html('<tr><td>0</td><td>Add speakers to get started!<td class="text-right"></td></tr>');
      });
      $("#clear-secondary").click(function(){
        $("#table-secondary").html('<tr><td>0</td><td>Add speakers to get started!<td class="text-right"></td></tr>');
      });
      $("#clear-caucas").click(function(){
        $("#table-caucas").html('<tr><td>0</td><td>Add speakers to get started!<td class="text-right"></td></tr>');
      });
      window.setInterval(function(){
       if (timer["on"]){
         incrementTimer(timer);
         $("#time-timer").html(getTimer(timer));
       }
      }, 1000);
    </script>
  </body>
</html>
